#  DAG Classifier ‚Äî Mixture of Experts via Graphs

## üîπ –ò–¥–µ—è –ø—Ä–æ–µ–∫—Ç–∞
**–º–æ–¥–µ–ª—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏** –Ω–∞ –æ—Å–Ω–æ–≤–µ **–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∞—Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–≥–æ –≥—Ä–∞—Ñ–∞ (DAG)**.  
–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –¥–µ—Ä–µ–≤—å–µ–≤ —Ä–µ—à–µ–Ω–∏–π (Decision Trees), –≥–¥–µ –∫–∞–∂–¥–æ–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ —Å–ª–µ–¥—É–µ—Ç –ø–æ **–æ–¥–Ω–æ–º—É –ø—É—Ç–∏**, –≤ DAG –æ–±—ä–µ–∫—Ç –º–æ–∂–µ—Ç ¬´—Ä–∞–∑–º–∞–∑—ã–≤–∞—Ç—å—Å—è¬ª –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –≤–µ—Ç–∫–∞–º, –∞ –∏—Ç–æ–≥–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –∫–∞–∫ **–≤–∑–≤–µ—à–µ–Ω–Ω–∞—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è —ç–∫—Å–ø–µ—Ä—Ç–æ–≤ –≤ –ª–∏—Å—Ç—å—è—Ö**.
 
- **–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —É–∑–ª—ã** –≤—ã—Å—Ç—É–ø–∞—é—Ç –≤ —Ä–æ–ª–∏ *–º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–æ–≤* (gating functions),  
- **–õ–∏—Å—Ç—å—è** —Å–æ–¥–µ—Ä–∂–∞—Ç –ø—Ä–æ—Å—Ç—ã–µ –º–æ–¥–µ–ª–∏ (–ª–∏–Ω–µ–π–Ω—ã–µ —Ä–µ–≥—Ä–µ—Å—Å–æ—Ä—ã –∏–ª–∏ –º–∞–ª–µ–Ω—å–∫–∏–µ MLP).

---

## üîπ –§–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞

–ü—É—Å—Ç—å —É –Ω–∞—Å –µ—Å—Ç—å –≤—Ö–æ–¥–Ω–æ–π –≤–µ–∫—Ç–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ **x ‚àà R^d**.  
–ú–æ–¥–µ–ª—å —Å–æ–¥–µ—Ä–∂–∏—Ç:
- –º–∞—Ç—Ä–∏—Ü—ã –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ **W(src‚Üíint)** –∏ **W(int‚Üíleaf)**,  
- –Ω–∞–±–æ—Ä —ç–∫—Å–ø–µ—Ä—Ç–æ–≤ –≤ –ª–∏—Å—Ç—å—è—Ö **f‚Çó(x)**.

1. **–ü–µ—Ä–µ—Ö–æ–¥ –æ—Ç –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º —É–∑–ª–∞–º:**  
h = x ¬∑ W(src‚Üíint) ‚àà R^H
2. **–ü–µ—Ä–µ—Ö–æ–¥ –∫ –ª–∏—Å—Ç—å—è–º –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Å–æ–≤:**
r = h ¬∑ W(int‚Üíleaf) ‚àà R^L
pi = softmax(r / œÑ) # œÑ ‚Äî —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞
3. **–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –≤ –ª–∏—Å—Ç—å—è—Ö:**
p_leaf(y | x) = softmax(W_leaf ¬∑ x + b_leaf)
4.  **–ê–≥—Ä–µ–≥–∞—Ü–∏—è –ø–æ –¥–µ—Ä–µ–≤—É:**
p(y | x) = Œ£ pi(x) * p_leaf(y | x)

---

## üîπ –û—Ç–ª–∏—á–∏–µ –æ—Ç Decision Trees

- –í –¥–µ—Ä–µ–≤—å—è—Ö —Ä–µ—à–µ–Ω–∏–π –∫–∞–∂–¥—ã–π –æ–±—ä–µ–∫—Ç –ø–æ–ø–∞–¥–∞–µ—Ç –≤ **–æ–¥–∏–Ω –ª–∏—Å—Ç**.  
- –í DAG –º–æ–¥–µ–ª—å –º–æ–∂–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å –≤–µ—Å –º–µ–∂–¥—É **–Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ª–∏—Å—Ç—å—è–º–∏**, —á—Ç–æ –±–ª–∏–∂–µ –∫ ¬´–º—è–≥–∫–æ–º—É¬ª —Ä–µ—à–µ–Ω–∏—é.  
- –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, DAG = *–¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä—É–µ–º—ã–π –∞–Ω–∞–ª–æ–≥ –¥–µ—Ä–µ–≤–∞* ‚Üí –º–æ–∂–Ω–æ –æ–±—É—á–∞—Ç—å —á–µ—Ä–µ–∑ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫.

---

## üîπ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

Input features (x)  
‚îÇ  
‚ñº  
Internal nodes (h)  
‚îú‚îÄ‚îÄ softmax/gumbel ‚îÄ‚îÄ‚ñ∫ Leaf 1 (expert)  
‚îú‚îÄ‚îÄ softmax/gumbel ‚îÄ‚îÄ‚ñ∫ Leaf 2 (expert)  
‚îî‚îÄ‚îÄ softmax/gumbel ‚îÄ‚îÄ‚ñ∫ Leaf 3 (expert)  

Each leaf ‚Üí outputs probabilities  
All leaves are combined (weighted sum)  
Final prediction: p(y|x)  

---

---

## üîπ –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã

–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ DAG-–º–æ–¥–µ–ª–∏ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–ª–æ—Å—å –Ω–∞ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö (**Iris**, **Wine**, **Digits**) –∏ –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ **Wine Quality (Kaggle)**.

- –ù–∞ **—É—á–µ–±–Ω—ã—Ö –Ω–∞–±–æ—Ä–∞—Ö** DAG –ø–æ–∫–∞–∑–∞–ª –∫–∞—á–µ—Å—Ç–≤–æ –Ω–∞ —É—Ä–æ–≤–Ω–µ –∏ –¥–∞–∂–µ –≤—ã—à–µ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö –º–µ—Ç–æ–¥–æ–≤ (Logistic Regression, Random Forest, MLP).  
- –ù–∞ **Wine Quality (—Ä–µ–∞–ª—å–Ω—ã–π –∫–µ–π—Å)** DAG —É—Å—Ç—É–ø–∏–ª –±–µ–π—Å–ª–∞–π–Ω–∞–º, —á—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –¥–∞–ª—å–Ω–µ–π—à–µ–π –¥–æ—Ä–∞–±–æ—Ç–∫–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã.

| Dataset              | Logistic Regression | Random Forest      | MLP (sklearn) | DAG (best)    |
|----------------------|---------------------|--------------------|---------------|---------------|
| Iris                 | 0.93                | 0.89               | 0.96          | **0.98**      |
| Wine                 | 0.98                | **1.00**           | 0.98          | **1.00**      |
| Digits               | **0.98**            | 0.97               | 0.98          | 0.97          |
| Wine Quality (3 cl)  | 0.78 (f1 0.43)      | **0.84** (f1 0.58) | 0.79 (f1 0.54)| 0.79 (f1 0.45)|

 **–í—ã–≤–æ–¥:** DAG-–º–æ–¥–µ–ª–∏ —Ö–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ –ø—Ä–æ—Å—Ç—ã—Ö —É—á–µ–±–Ω—ã—Ö –Ω–∞–±–æ—Ä–∞—Ö, –Ω–æ —É—Å—Ç—É–ø–∞—é—Ç –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–º –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö.
